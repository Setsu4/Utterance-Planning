# Utterance-Planning

## 概要

Utterance-Planningは、ニュース記事をもとに対話型で要約・説明を行うPythonプログラムです。  
ユーザーがニュース記事を入力すると、OpenAI APIを利用して「発話計画（システム発話＋想定質問とその回答）」を自動生成します。その後、ユーザーとの対話を通じて、計画に沿った説明や質問応答を行います。  
本プロジェクトは、対話的な要約説明や発話計画の自動生成・活用の研究・実験に利用できます。

---

## 特徴

- ニュース記事を話し言葉で分かりやすく要約・説明
- 発話計画（複数ターンのシステム発話＋想定QA）を自動生成
- ユーザーの質問に対し、計画内QAまたは即時生成で柔軟に回答
- 相槌判定やタイムアウト付き入力など、実用的な対話制御

---

## 必要環境

- Linux環境（`select.select`によるタイムアウト入力のため）
- Python 3.10
- OpenAI APIキー・組織ID（環境変数で設定）

---

## セットアップ手順

### 1. 仮想環境の作成

本プロジェクトでは、`environment.yml` を用いて必要なパッケージを一括インストールできます。

```bash
conda env create -f environment.yml
conda activate u_planning
```

### 2. OpenAI APIキー・組織IDの設定

APIキーと組織IDは環境変数として設定してください。  
以下のコマンドを実行し、環境変数をエクスポートします（シェル起動ごとに必要です。必要に応じて `.bashrc` などに追記してください）。

```bash
export OPENAI_API_KEY="sk-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"
export OPENAI_ORGANIZATION="org-xxxxxxxxxxxxxxxxxxxx"
```

---

## 使い方

1. 仮想環境をアクティベートします。

    ```bash
    conda activate u_planning
    ```

2. 必ずAPIキーと組織IDを環境変数として設定してください（上記参照）。

3. プログラムを実行します。

    ```bash
    python conversation_morita.py
    ```

4. プロンプトが表示されたら、要約したいニュース記事の本文を貼り付けてEnterを押してください。

5. システムが発話計画を生成し、対話が始まります。  
   各発話ごとにユーザーの質問や相槌を20秒間待ちます。  
   - 想定質問に近い内容なら計画内の回答を返します。
   - それ以外の質問には即時で要約内容から回答を生成します。
   - 相槌や無応答の場合は次の発話に進みます。

---

## ファイル構成

- `conversation_morita.py`  
  メインの対話プログラム。発話計画の生成・解析・対話制御を行います。

- `environment.yml`  
  必要なPythonパッケージ・ライブラリを記載した環境定義ファイル。

- `README.md`  
  この説明ファイル。

---

## 注意事項

- OpenAI APIの利用には料金が発生する場合があります。APIキーの管理・利用には十分ご注意ください。
- Windows環境ではタイムアウト付き入力が動作しません（Linux/Mac推奨）。
- ニュース記事の内容や長さによっては、発話計画の生成に時間がかかる場合があります。

---

## ライセンス

本リポジトリの内容は研究・教育目的での利用を想定しています。商用利用や再配布についてはご相談ください。